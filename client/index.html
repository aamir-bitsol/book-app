<!-- 
<script type="text/javascript">
  const eventSource = new EventSource('/likes/events');
  eventSource.onmessage = ({ data }) => {
    const message = document.createElement('li');
    message.innerText = data;
    document.body.appendChild(message);
  }
</script>  
 -->


 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
Data events:<br/>
<div id="result"></div>
<hr/>
Errors:<br/>
<div id="errors"></div>
<hr/>
Create parallel event:<br/>

<form id="form1">
    <input type="submit" value="Get">
</form>

<form id="form2">
    <input type="submit" value="Post">
</form>

<form id="form3">
    <input type="submit" value="Delete">
</form>

<script type="text/javascript">
  const subscription = new EventSource(`/likes/events`);
  subscription.onmessage = (message) => {
    document.getElementById("result").innerHTML += message.data + "<br/>";
  };
  subscription.onerror = (message) => {
    document.getElementById("errors").innerHTML += JSON.stringify(message) + "<br/>";
  };

  function formSubmitLikesGet(event) {
    const url = "/likes";
    const request = new XMLHttpRequest();
    request.open('GET', url, true);
    request.onload = function () {
      console.log(request.responseText);
    };
    request.send(new FormData(event.target));
    event.preventDefault();
  }
  function formSubmitLikesPost(event) {
    const url = "/likes";
    const request = new XMLHttpRequest();
    request.open('POST', url, true);
    request.onload = function () {
      console.log(request.responseText);
    };
    request.send(new FormData(event.target));
    event.preventDefault();
  }
  function formSubmitDelete(event) {
    const url = "/likes";
    const request = new XMLHttpRequest();
    request.open('DELETE', url, true);
    request.onload = function () {
      console.log(request.responseText);
    };
    request.send(new FormData(event.target));
    event.preventDefault();
  }

  document.getElementById("form1").addEventListener("submit", formSubmitLikesGet);
  document.getElementById("form2").addEventListener("submit", formSubmitLikesPost);
  document.getElementById("form3").addEventListener("submit", formSubmitDelete);
</script>

</body>
</html>
